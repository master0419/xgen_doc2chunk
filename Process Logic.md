# xgen_doc2chunk Processing Flow

---

## Main Flow

```
User calls: processor.extract_chunks(file_path)
                    ??
                    ??
         DocumentProcessor.extract_chunks()
                    ??
                    ?ú‚???extract_text()
                    ??      ??
                    ??      ?ú‚???_create_current_file(file_path)
                    ??      ?ú‚???_get_handler(extension)
                    ??      ?ú‚???handler.extract_text(current_file)
                    ??      ?î‚???OCR processing (optional)
                    ??
                    ?î‚???chunk_text()
                            ??
                            ?î‚???create_chunks()
```

---

## PDF Handler Flow

```
PDFHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.convert(file_data)               [INTERFACE: PDFFileConverter]
    ??      ?î‚???Binary ??fitz.Document
    ??
    ?ú‚???preprocessor.preprocess(doc)                    [INTERFACE: PDFPreprocessor]
    ??      ?î‚???Pass-through (returns PreprocessedData with doc unchanged)
    ??
    ?ú‚???metadata_extractor.extract()                    [INTERFACE: PDFMetadataExtractor]
    ??
    ?ú‚???_extract_all_tables(doc, file_path)             [INTERNAL]
    ??
    ?î‚???For each page:
            ??
            ?ú‚???ComplexityAnalyzer.analyze()            [CLASS: pdf_complexity_analyzer]
            ??      ?î‚???Returns PageComplexity with recommended_strategy
            ??
            ?ú‚???Branch by strategy:
            ??      ??
            ??      ?ú‚???FULL_PAGE_OCR:
            ??      ??      ?î‚???_process_page_full_ocr()
            ??      ??
            ??      ?ú‚???BLOCK_IMAGE_OCR:
            ??      ??      ?î‚???_process_page_block_ocr()
            ??      ??
            ??      ?ú‚???HYBRID:
            ??      ??      ?î‚???_process_page_hybrid()
            ??      ??
            ??      ?î‚???TEXT_EXTRACTION (default):
            ??              ?î‚???_process_page_text_extraction()
            ??                      ??
            ??                      ?ú‚???VectorTextOCREngine.detect_and_extract()
            ??                      ?ú‚???extract_text_blocks()           [FUNCTION]
            ??                      ?ú‚???format_image_processor methods  [INTERFACE: PDFImageProcessor]
            ??                      ?î‚???merge_page_elements()           [FUNCTION]
            ??
            ?î‚???page_tag_processor.create_page_tag()    [INTERFACE: PageTagProcessor]
```

---

## DOCX Handler Flow

```
DOCXHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.validate(file_data)              [INTERFACE: DOCXFileConverter]
    ??      ?î‚???Check if valid ZIP with [Content_Types].xml
    ??
    ?ú‚???If not valid DOCX:
    ??      ?î‚???_extract_with_doc_handler_fallback()    [INTERNAL]
    ??              ?î‚???DOCHandler.extract_text()       [DELEGATION]
    ??
    ?ú‚???file_converter.convert(file_data)               [INTERFACE: DOCXFileConverter]
    ??      ?î‚???Binary ??docx.Document
    ??
    ?ú‚???preprocessor.preprocess(doc)                    [INTERFACE: DOCXPreprocessor]
    ??      ?î‚???Returns PreprocessedData (doc in extracted_resources)
    ??
    ?ú‚???chart_extractor.extract_all_from_file()         [INTERFACE: DOCXChartExtractor]
    ??      ?î‚???Pre-extract all charts (callback pattern)
    ??
    ?ú‚???metadata_extractor.extract()                    [INTERFACE: DOCXMetadataExtractor]
    ??
    ?î‚???For each element in doc.element.body:
            ??
            ?ú‚???If paragraph ('p'):
            ??      ?î‚???process_paragraph_element()     [FUNCTION: docx_helper]
            ??              ?ú‚???format_image_processor.process_drawing_element()
            ??              ?ú‚???format_image_processor.extract_from_pict()
            ??              ?î‚???get_next_chart() callback for charts
            ??
            ?î‚???If table ('tbl'):
                    ?î‚???process_table_element()         [FUNCTION: docx_helper]
```

---

## DOC Handler Flow

```
DOCHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.convert()                        [INTERFACE: DOCFileConverter]
    ??      ??
    ??      ?ú‚???_detect_format() ??DocFormat (RTF/OLE/HTML/DOCX)
    ??      ??
    ??      ?ú‚???RTF: file_data (bytes) Î∞òÌôò             [Pass-through]
    ??      ?ú‚???OLE: _convert_ole() ??olefile.OleFileIO
    ??      ?ú‚???HTML: _convert_html() ??BeautifulSoup
    ??      ?î‚???DOCX: _convert_docx() ??docx.Document
    ??
    ?ú‚???preprocessor.preprocess(converted_obj)          [INTERFACE: DOCPreprocessor]
    ??      ?î‚???Returns PreprocessedData (converted_obj in extracted_resources)
    ??
    ?ú‚???RTF format detected:
    ??      ?î‚???_delegate_to_rtf_handler()              [DELEGATION]
    ??              ?î‚???RTFHandler.extract_text(current_file)
    ??
    ?ú‚???OLE format detected:
    ??      ?î‚???_extract_from_ole_obj()                 [INTERNAL]
    ??              ?ú‚???_extract_ole_metadata()
    ??              ?ú‚???_extract_ole_text()
    ??              ?î‚???_extract_ole_images()
    ??
    ?ú‚???HTML format detected:
    ??      ?î‚???_extract_from_html_obj()                [INTERNAL]
    ??              ?ú‚???_extract_html_metadata()
    ??              ?î‚???BeautifulSoup parsing
    ??
    ?î‚???DOCX format detected:
            ?î‚???_extract_from_docx_obj()                [INTERNAL]
                    ?î‚???docx.Document paragraph/table extraction
```

---

## RTF Handler Flow

**Íµ¨Ï°∞**: Converter??pass-through, Preprocessor?êÏÑú binary Ï≤òÎ¶¨, Handler?êÏÑú ?úÏ∞®??Ï≤òÎ¶¨.

```
RTFHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.convert()                        [INTERFACE: RTFFileConverter]
    ??      ?î‚???Pass-through (returns raw bytes)
    ??
    ?ú‚???preprocessor.preprocess()                       [INTERFACE: RTFPreprocessor]
    ??      ??
    ??      ?ú‚???\binN tag processing (skip binary data)
    ??      ?ú‚???\pict group image extraction
    ??      ?î‚???Returns PreprocessedData (clean_content, image_tags, encoding)
    ??
    ?ú‚???decode_content()                                [FUNCTION: rtf_decoder]
    ??      ?î‚???bytes ??string with detected encoding
    ??
    ?ú‚???Build RTFConvertedData                          [DATACLASS]
    ??
    ?î‚???_extract_from_converted()                       [INTERNAL]
            ??
            ?ú‚???metadata_extractor.extract()            [INTERFACE: RTFMetadataExtractor]
            ?ú‚???metadata_extractor.format()
            ??
            ?ú‚???extract_tables_with_positions()         [FUNCTION: rtf_table_extractor]
            ??
            ?ú‚???extract_inline_content()                [FUNCTION: rtf_content_extractor]
            ??
            ?î‚???Build result string
```

---

## Excel Handler Flow (XLSX)

```
ExcelHandler.extract_text(current_file) [XLSX]
    ??
    ?ú‚???file_converter.convert(file_data, extension='xlsx')  [INTERFACE: ExcelFileConverter]
    ??      ?î‚???Binary ??openpyxl.Workbook
    ??
    ?ú‚???preprocessor.preprocess(wb)                     [INTERFACE: ExcelPreprocessor]
    ??      ?î‚???Returns PreprocessedData (wb in extracted_resources)
    ??
    ?ú‚???_preload_xlsx_data()                            [INTERNAL]
    ??      ?ú‚???metadata_extractor.extract()            [INTERFACE: XLSXMetadataExtractor]
    ??      ?ú‚???chart_extractor.extract_all_from_file() [INTERFACE: ExcelChartExtractor]
    ??      ?î‚???format_image_processor.extract_images() [INTERFACE: ExcelImageProcessor]
    ??
    ?î‚???For each sheet:
            ??
            ?ú‚???_process_xlsx_sheet()                   [INTERNAL]
            ??      ?ú‚???page_tag_processor.create_sheet_tag()  [INTERFACE: PageTagProcessor]
            ??      ?ú‚???extract_textboxes_from_xlsx()   [FUNCTION]
            ??      ?ú‚???convert_xlsx_sheet_to_table()   [FUNCTION]
            ??      ?î‚???convert_xlsx_objects_to_tables()[FUNCTION]
            ??
            ?î‚???format_image_processor.get_sheet_images()  [INTERFACE: ExcelImageProcessor]
```

---

## Excel Handler Flow (XLS)

```
ExcelHandler.extract_text(current_file) [XLS]
    ??
    ?ú‚???file_converter.convert(file_data, extension='xls')   [INTERFACE: ExcelFileConverter]
    ??      ?î‚???Binary ??xlrd.Book
    ??
    ?ú‚???preprocessor.preprocess(wb)                     [INTERFACE: ExcelPreprocessor]
    ??      ?î‚???Returns PreprocessedData (wb in extracted_resources)
    ??
    ?ú‚???_get_xls_metadata_extractor().extract_and_format()   [INTERFACE: XLSMetadataExtractor]
    ??
    ?î‚???For each sheet:
            ??
            ?ú‚???page_tag_processor.create_sheet_tag()   [INTERFACE: PageTagProcessor]
            ??
            ?ú‚???convert_xls_sheet_to_table()            [FUNCTION]
            ??
            ?î‚???convert_xls_objects_to_tables()         [FUNCTION]
```

---

## PPT Handler Flow

```
PPTHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.convert(file_data, file_stream)  [INTERFACE: PPTFileConverter]
    ??      ?î‚???Binary ??pptx.Presentation
    ??
    ?ú‚???preprocessor.preprocess(prs)                    [INTERFACE: PPTPreprocessor]
    ??      ?î‚???Returns PreprocessedData (prs in extracted_resources)
    ??
    ?ú‚???chart_extractor.extract_all_from_file()         [INTERFACE: PPTChartExtractor]
    ??      ?î‚???Pre-extract all charts (callback pattern)
    ??
    ?ú‚???metadata_extractor.extract()                    [INTERFACE: PPTMetadataExtractor]
    ?ú‚???metadata_extractor.format()                     [INTERFACE: PPTMetadataExtractor]
    ??
    ?î‚???For each slide:
            ??
            ?ú‚???page_tag_processor.create_slide_tag()   [INTERFACE: PageTagProcessor]
            ??
            ?î‚???For each shape:
                    ??
                    ?ú‚???If table: convert_table_to_html()       [FUNCTION]
                    ?ú‚???If chart: get_next_chart() callback     [Pre-extracted]
                    ?ú‚???If picture: process_image_shape()       [FUNCTION]
                    ?ú‚???If group: process_group_shape()         [FUNCTION]
                    ?î‚???If text: extract_text_with_bullets()    [FUNCTION]
```

---

## HWP Handler Flow

```
HWPHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.validate(file_data)              [INTERFACE: HWPFileConverter]
    ??      ?î‚???Check if OLE file (magic number check)
    ??
    ?ú‚???If not OLE file:
    ??      ?î‚???_handle_non_ole_file()                  [INTERNAL]
    ??              ?ú‚???ZIP detected ??HWPXHandler delegation
    ??              ?î‚???HWP 3.0 ??Not supported
    ??
    ?ú‚???chart_extractor.extract_all_from_file()         [INTERFACE: HWPChartExtractor]
    ??
    ?ú‚???file_converter.convert()                        [INTERFACE: HWPFileConverter]
    ??      ?î‚???Binary ??olefile.OleFileIO
    ??
    ?ú‚???preprocessor.preprocess(ole)                    [INTERFACE: HWPPreprocessor]
    ??      ?î‚???Returns PreprocessedData (ole in extracted_resources)
    ??
    ?ú‚???metadata_extractor.extract()                    [INTERFACE: HWPMetadataExtractor]
    ?ú‚???metadata_extractor.format()                     [INTERFACE: HWPMetadataExtractor]
    ??
    ?ú‚???_parse_docinfo(ole)                             [INTERNAL]
    ??      ?î‚???parse_doc_info()                        [FUNCTION]
    ??
    ?ú‚???_extract_body_text(ole)                         [INTERNAL]
    ??      ??
    ??      ?î‚???For each section:
    ??              ?ú‚???decompress_section()            [FUNCTION]
    ??              ?î‚???_parse_section()                [INTERNAL]
    ??                      ?î‚???_process_picture()      [INTERNAL - format_image_processor ?¨Ïö©]
    ??
    ?ú‚???format_image_processor.process_images_from_bindata()  [INTERFACE: HWPImageProcessor]
    ??
    ?î‚???file_converter.close(ole)                       [INTERFACE: HWPFileConverter]
```

---

## HWPX Handler Flow

```
HWPXHandler.extract_text(current_file)
    ??
    ?ú‚???get_file_stream(current_file)                   [INHERITED: BaseHandler]
    ??      ?î‚???BytesIO(file_data)
    ??
    ?ú‚???_is_valid_zip(file_stream)                      [INTERNAL]
    ??
    ?ú‚???chart_extractor.extract_all_from_file()         [INTERFACE: HWPXChartExtractor]
    ??
    ?ú‚???zipfile.ZipFile(file_stream)                    [EXTERNAL LIBRARY]
    ??
    ?ú‚???preprocessor.preprocess(zf)                     [INTERFACE: HWPXPreprocessor]
    ??      ?î‚???Returns PreprocessedData (extracted_resources available)
    ??
    ?ú‚???metadata_extractor.extract()                    [INTERFACE: HWPXMetadataExtractor]
    ?ú‚???metadata_extractor.format()                     [INTERFACE: HWPXMetadataExtractor]
    ??
    ?ú‚???parse_bin_item_map(zf)                          [FUNCTION]
    ??
    ?ú‚???For each section:
    ??      ??
    ??      ?î‚???parse_hwpx_section()                    [FUNCTION]
    ??              ??
    ??              ?ú‚???format_image_processor.process_images()  [INTERFACE: HWPXImageProcessor]
    ??              ??
    ??              ?î‚???parse_hwpx_table()              [FUNCTION]
    ??
    ?î‚???format_image_processor.get_remaining_images()   [INTERFACE: HWPXImageProcessor]
        format_image_processor.process_images()         [INTERFACE: HWPXImageProcessor]
```

---

## CSV Handler Flow

```
CSVHandler.extract_text(current_file)
    ??
    ?ú‚???file_converter.convert(file_data, encoding)     [INTERFACE: CSVFileConverter]
    ??      ?î‚???Binary ??Text (with encoding detection)
    ??
    ?ú‚???preprocessor.preprocess(content)                [INTERFACE: CSVPreprocessor]
    ??      ?î‚???Returns PreprocessedData (content in clean_content)
    ??
    ?ú‚???detect_delimiter(content)                       [FUNCTION]
    ??
    ?ú‚???parse_csv_content(content, delimiter)           [FUNCTION]
    ??
    ?ú‚???detect_header(rows)                             [FUNCTION]
    ??
    ?ú‚???metadata_extractor.extract(source_info)         [INTERFACE: CSVMetadataExtractor]
    ??      ?î‚???CSVSourceInfo contains: file_path, encoding, delimiter, rows, has_header
    ??
    ?î‚???convert_rows_to_table(rows, has_header)         [FUNCTION]
            ?î‚???Returns HTML table
```

---

## Text Handler Flow

```
TextHandler.extract_text(current_file)
    ??
    ?ú‚???preprocessor.preprocess(file_data)              [INTERFACE: TextPreprocessor]
    ??      ?î‚???Returns PreprocessedData (file_data in clean_content)
    ??
    ?ú‚???file_data.decode(encoding)                      [DIRECT: No FileConverter used]
    ??      ?î‚???Try encodings: utf-8, utf-8-sig, cp949, euc-kr, latin-1, ascii
    ??
    ?î‚???clean_text() / clean_code_text()                [FUNCTION: utils.py]
```

Note: TextHandler??file_converterÎ•??¨Ïö©?òÏ? ?äÍ≥† ÏßÅÏ†ë decode?©Îãà??

---

## HTML Handler Flow

```
HTMLReprocessor (Utility - NOT a BaseHandler subclass)
    ??
    ?ú‚???clean_html_file(html_content)                   [FUNCTION]
    ??      ??
    ??      ?ú‚???BeautifulSoup parsing
    ??      ?ú‚???Remove unwanted tags (script, style, etc.)
    ??      ?ú‚???Remove style attributes
    ??      ?ú‚???_process_table_merged_cells()
    ??      ?î‚???Return cleaned HTML string
    ??
    ?î‚???Used by DOCHandler when HTML format detected
```

Note: HTML?Ä Î≥ÑÎèÑ??BaseHandler ?úÎ∏å?¥Îûò?§Í? ?ÜÏäµ?àÎã§.
      DOCHandlerÍ∞Ä HTML ?ïÏãù??Í∞êÏ??òÎ©¥ ?¥Î??ÅÏúºÎ°?BeautifulSoup?ºÎ°ú Ï≤òÎ¶¨?©Îãà??

---

## Image File Handler Flow

```
ImageFileHandler.extract_text(current_file)
    ??
    ?ú‚???preprocessor.preprocess(file_data)              [INTERFACE: ImageFilePreprocessor]
    ??      ?î‚???Returns PreprocessedData (file_data in clean_content)
    ??
    ?ú‚???Validate file extension                         [INTERNAL]
    ??      ?î‚???SUPPORTED_IMAGE_EXTENSIONS: jpg, jpeg, png, gif, bmp, webp
    ??
    ?ú‚???If OCR engine is None:
    ??      ?î‚???_build_image_tag(file_path)             [INTERNAL]
    ??              ?î‚???Return [image:path] tag
    ??
    ?î‚???If OCR engine available:
            ?î‚???_ocr_engine.extract_text()              [INTERFACE: BaseOCR]
                    ?î‚???Image ??Text via OCR
```

Note: ImageFileHandler??OCR ?îÏßÑ???§Ï†ï??Í≤ΩÏö∞?êÎßå ?§Ï†ú ?çÏä§??Ï∂îÏ∂ú??Í∞Ä?•Ìï©?àÎã§.

---

## Chunking Flow

```
chunk_text(text, chunk_size, chunk_overlap)
    ??
    ?î‚???create_chunks()                                 [FUNCTION]
            ??
            ?ú‚???_extract_document_metadata()            [FUNCTION]
            ??
            ?ú‚???Detect file type:
            ??      ??
            ??      ?ú‚???Table-based (xlsx, xls, csv):
            ??      ??      ?î‚???chunk_multi_sheet_content()  [FUNCTION]
            ??      ??
            ??      ?ú‚???Text with page markers:
            ??      ??      ?î‚???chunk_by_pages()        [FUNCTION]
            ??      ??
            ??      ?î‚???Plain text:
            ??              ?î‚???chunk_plain_text()      [FUNCTION]
            ??
            ?î‚???_prepend_metadata_to_chunks()           [FUNCTION]
```

---

## Interface Integration Summary

```
?å‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Handler     ??FileConverter       ??Preprocessor        ??MetadataExtractor   ??ChartExtractor      ??FormatImageProcessor??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??PDF         ????PDFFileConverter  ????PDFPreprocessor   ????PDFMetadata       ????NullChart         ????PDFImage          ??
??DOCX        ????DOCXFileConverter ????DOCXPreprocessor  ????DOCXMetadata      ????DOCXChart         ????DOCXImage         ??
??DOC         ????DOCFileConverter  ????DOCPreprocessor   ????NullMetadata      ????NullChart         ????DOCImage          ??
??RTF         ????RTFFileConverter  ????RTFPreprocessor*  ????RTFMetadata       ????NullChart         ????Uses base         ??
??XLSX        ????ExcelFileConverter????ExcelPreprocessor ????XLSXMetadata      ????ExcelChart        ????ExcelImage        ??
??XLS         ????ExcelFileConverter????ExcelPreprocessor ????XLSMetadata       ????ExcelChart        ????ExcelImage        ??
??PPT/PPTX    ????PPTFileConverter  ????PPTPreprocessor   ????PPTMetadata       ????PPTChart          ????PPTImage          ??
??HWP         ????HWPFileConverter  ????HWPPreprocessor   ????HWPMetadata       ????HWPChart          ????HWPImage          ??
??HWPX        ????None (ÏßÅÏ†ë ZIP)   ????HWPXPreprocessor  ????HWPXMetadata      ????HWPXChart         ????HWPXImage         ??
??CSV         ????CSVFileConverter  ????CSVPreprocessor   ????CSVMetadata       ????NullChart         ????CSVImage          ??
??TXT/MD/JSON ????None (ÏßÅÏ†ë decode)????TextPreprocessor  ????NullMetadata      ????NullChart         ????TextImage         ??
??HTML        ????N/A (?†Ìã∏Î¶¨Ìã∞)    ????N/A               ????N/A               ????N/A               ????N/A               ??
??Image Files ????ImageFileConverter????ImagePreprocessor ????NullMetadata      ????NullChart         ????ImageFileImage    ??
?î‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??

??= Interface implemented
??= Not applicable / NullExtractor / Not used
* = RTFPreprocessor has actual processing logic (image extraction, binary cleanup)
```

---

## Handler Processing Pipeline

Î™®Îì† ?∏Îì§?¨Îäî ?ôÏùº??Ï≤òÎ¶¨ ?åÏù¥?ÑÎùº?∏ÏùÑ ?∞Î¶Ö?àÎã§:

```
?å‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??                          Handler Processing Pipeline                             ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??                                                                                  ??
?? 1. FileConverter.convert()     Binary ??Format-specific object                  ??
??        ??                      (fitz.Document, docx.Document, olefile, etc.)    ??
??        ??                                                                        ??
?? 2. Preprocessor.preprocess()   Process/clean the converted data                 ??
??        ??                      (image extraction, binary cleanup, encoding)     ??
??        ??                                                                        ??
?? 3. MetadataExtractor.extract() Extract document metadata                        ??
??        ??                      (title, author, created date, etc.)              ??
??        ??                                                                        ??
?? 4. Content Extraction          Format-specific content extraction               ??
??        ??                      (text, tables, images, charts)                   ??
??        ??                                                                        ??
?? 5. Result Assembly             Build final result string                        ??
??                                                                                  ??
?î‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??

Note: ?ÄÎ∂ÄÎ∂ÑÏùò ?∏Îì§?¨Ïóê??Preprocessor??pass-through (NullPreprocessor).
      RTF???àÏô∏Î°? RTFPreprocessor?êÏÑú ?§Ï†ú Î∞îÏù¥?àÎ¶¨ Ï≤òÎ¶¨Í∞Ä ?¥Î£®?¥Ïßê.
```

---

## Remaining Function-Based Components

```
?å‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¨‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Handler     ??Function-Based Components                                  ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??PDF         ??extract_text_blocks(), merge_page_elements(),             ??
??            ??ComplexityAnalyzer, VectorTextOCREngine,                  ??
??            ??BlockImageEngine                                          ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??DOCX        ??process_paragraph_element(), process_table_element()      ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??DOC         ??Format detection, OLE/HTML/DOCX internal processing       ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??RTF         ??decode_content() (rtf_decoder.py)                         ??
??            ??extract_tables_with_positions() (rtf_table_extractor.py)  ??
??            ??extract_inline_content() (rtf_content_extractor.py)       ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Excel       ??extract_textboxes_from_xlsx(), convert_xlsx_sheet_to_table??
??            ??convert_xls_sheet_to_table(), convert_*_objects_to_tables ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??PPT         ??extract_text_with_bullets(), convert_table_to_html(),     ??
??            ??process_image_shape(), process_group_shape()              ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??HWP         ??parse_doc_info(), decompress_section()                    ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??HWPX        ??parse_bin_item_map(), parse_hwpx_section()                ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??CSV         ??detect_delimiter(), parse_csv_content(), detect_header(), ??
??            ??convert_rows_to_table()                                   ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Text        ??clean_text(), clean_code_text() (utils.py)                ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??HTML        ??clean_html_file(), _process_table_merged_cells()          ??
??            ??(html_reprocessor.py - utility, not handler)              ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Image       ??OCR engine integration (BaseOCR subclass)                 ??
?ú‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?º‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
??Chunking    ??create_chunks(), chunk_by_pages(), chunk_plain_text(),    ??
??            ??chunk_multi_sheet_content(), chunk_large_table()          ??
?î‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?¥‚??Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä?Ä??
```
